/* ==============================================
   代码高亮主题系统
   ============================================== */

/* 代码高亮 CSS 变量定义 */
:root {
  /* 浅色主题 - 更温和的背景色 */
  --code-bg: #fbfcfe;
  --code-border: #e1e8ed;
  --code-text: #2d3748;
  --code-comment: #718096;
  --code-keyword: #805ad5;
  --code-string: #38a169;
  --code-number: #e53e3e;
  --code-function: #3182ce;
  --code-operator: #1a202c;
  
  /* 行内代码 */
  --inline-code-bg: #edf2f7;
  --inline-code-text: #d53f8c;
  --inline-code-border: #e2e8f0;
  
  /* 语言标签 */
  --lang-label-bg: #f7fafc;
  --lang-label-text: #4a5568;
  --lang-label-border: #cbd5e0;
  
  /* 复制按钮 */
  --copy-btn-bg: rgba(255, 255, 255, 0.95);
  --copy-btn-bg-hover: rgba(255, 255, 255, 1);
  --copy-btn-text: #718096;
  --copy-btn-text-hover: #4a5568;
  --copy-btn-border: #cbd5e0;
  --copy-btn-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
  
  /* 滚动条 */
  --scrollbar-track: transparent;
  --scrollbar-thumb: #cbd5e0;
  --scrollbar-thumb-hover: #a0aec0;
}

/* 暗色主题 */
.dark {
  /* 代码块背景 - 更温和的暗色 */
  --code-bg: #1a202c;
  --code-border: #2d3748;
  --code-text: #f7fafc;
  --code-comment: #a0aec0;
  --code-keyword: #bb86fc;
  --code-string: #68d391;
  --code-number: #fc8181;
  --code-function: #63b3ed;
  --code-operator: #f7fafc;
  
  /* 行内代码 */
  --inline-code-bg: #2d3748;
  --inline-code-text: #fbb6ce;
  --inline-code-border: #4a5568;
  
  /* 语言标签 */
  --lang-label-bg: #2d3748;
  --lang-label-text: #e2e8f0;
  --lang-label-border: #4a5568;
  
  /* 复制按钮 */
  --copy-btn-bg: rgba(45, 55, 72, 0.95);
  --copy-btn-bg-hover: rgba(45, 55, 72, 1);
  --copy-btn-text: #e2e8f0;
  --copy-btn-text-hover: #f7fafc;
  --copy-btn-border: #4a5568;
  --copy-btn-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
  
  /* 滚动条 */
  --scrollbar-track: transparent;
  --scrollbar-thumb: #4a5568;
  --scrollbar-thumb-hover: #718096;
}

/* ==============================================
   代码高亮基础样式
   ============================================== */

/* 代码块容器 */
.prose pre {
  position: relative !important;
  background: var(--code-bg) !important;
  border: 1px solid var(--code-border) !important;
  border-radius: 0.75rem !important;
  padding: 1.5rem !important;
  margin: 2.5rem 0 2rem 0 !important;
  overflow-x: auto !important;
  font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace !important;
  font-size: 0.875rem !important;
  line-height: 1.7 !important;
  color: var(--code-text) !important;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06) !important;
}

/* 代码内容 */
.prose pre code {
  background: transparent !important;
  padding: 0 !important;
  border-radius: 0 !important;
  color: inherit !important;
  font-family: inherit !important;
  font-size: inherit !important;
  line-height: inherit !important;
}

/* 行内代码 */
.prose code:not(pre code) {
  background: var(--inline-code-bg) !important;
  color: var(--inline-code-text) !important;
  border: 1px solid var(--inline-code-border) !important;
  padding: 0.125rem 0.375rem !important;
  border-radius: 0.375rem !important;
  font-size: 0.875em !important;
  font-weight: 600 !important;
  font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace !important;
}

/* ==============================================
   语言标签样式
   ============================================== */

.language-label {
  position: absolute !important;
  top: -2rem !important;
  left: 0 !important;
  z-index: 10 !important;
  background: var(--lang-label-bg) !important;
  color: var(--lang-label-text) !important;
  border: 1px solid var(--lang-label-border) !important;
  border-bottom: none !important;
  border-top-left-radius: 0.5rem !important;
  border-top-right-radius: 0.5rem !important;
  padding: 0.375rem 0.75rem !important;
  font-size: 0.75rem !important;
  font-weight: 600 !important;
  letter-spacing: 0.05em !important;
  text-transform: uppercase !important;
  box-shadow: var(--copy-btn-shadow) !important;
}

/* 有语言标签的代码块调整 */
.prose pre:has(.language-label) {
  border-top-left-radius: 0 !important;
  margin-top: 3rem !important;
}

/* ==============================================
   复制按钮样式
   ============================================== */

.copy-button {
  position: absolute !important;
  top: 0.75rem !important;
  right: 0.75rem !important;
  z-index: 20 !important;
  display: flex !important;
  align-items: center !important;
  gap: 0.375rem !important;
  background: var(--copy-btn-bg) !important;
  color: var(--copy-btn-text) !important;
  border: 1px solid var(--copy-btn-border) !important;
  border-radius: 0.5rem !important;
  padding: 0.5rem 0.75rem !important;
  font-size: 0.75rem !important;
  font-weight: 500 !important;
  cursor: pointer !important;
  transition: all 0.2s ease-in-out !important;
  backdrop-filter: blur(8px) !important;
  box-shadow: var(--copy-btn-shadow) !important;
}

.copy-button:hover {
  background: var(--copy-btn-bg-hover) !important;
  color: var(--copy-btn-text-hover) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
}

.copy-button:active {
  transform: translateY(0) !important;
  box-shadow: var(--copy-btn-shadow) !important;
}

/* 复制成功状态 */
.copy-button.success {
  color: #059669 !important;
  border-color: #059669 !important;
}

.dark .copy-button.success {
  color: #34d399 !important;
  border-color: #34d399 !important;
}

/* ==============================================
   滚动条样式
   ============================================== */

.prose pre::-webkit-scrollbar {
  height: 8px !important;
}

.prose pre::-webkit-scrollbar-track {
  background: var(--scrollbar-track) !important;
}

.prose pre::-webkit-scrollbar-thumb {
  background: var(--scrollbar-thumb) !important;
  border-radius: 4px !important;
}

.prose pre::-webkit-scrollbar-thumb:hover {
  background: var(--scrollbar-thumb-hover) !important;
}

/* Firefox 滚动条 */
.prose pre {
  scrollbar-width: thin !important;
  scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track) !important;
}

/* ==============================================
   语法高亮 Token 样式
   ============================================== */

.prose pre .token.comment,
.prose pre .token.prolog,
.prose pre .token.doctype,
.prose pre .token.cdata {
  color: var(--code-comment) !important;
  font-style: italic !important;
}

.prose pre .token.punctuation {
  color: var(--code-text) !important;
}

.prose pre .token.property,
.prose pre .token.tag,
.prose pre .token.boolean,
.prose pre .token.number,
.prose pre .token.constant,
.prose pre .token.symbol,
.prose pre .token.deleted {
  color: var(--code-number) !important;
}

.prose pre .token.selector,
.prose pre .token.attr-name,
.prose pre .token.string,
.prose pre .token.char,
.prose pre .token.builtin,
.prose pre .token.inserted {
  color: var(--code-string) !important;
}

.prose pre .token.operator,
.prose pre .token.entity,
.prose pre .token.url,
.prose pre .language-css .token.string,
.prose pre .style .token.string {
  color: var(--code-operator) !important;
}

.prose pre .token.atrule,
.prose pre .token.attr-value,
.prose pre .token.keyword {
  color: var(--code-keyword) !important;
  font-weight: 600 !important;
}

.prose pre .token.function,
.prose pre .token.class-name {
  color: var(--code-function) !important;
  font-weight: 500 !important;
}

.prose pre .token.regex,
.prose pre .token.important,
.prose pre .token.variable {
  color: var(--code-keyword) !important;
}

.prose pre .token.important,
.prose pre .token.bold {
  font-weight: 700 !important;
}

.prose pre .token.italic {
  font-style: italic !important;
}

/* ==============================================
   响应式适配
   ============================================== */

@media (max-width: 640px) {
  .prose pre {
    margin-left: -1rem !important;
    margin-right: -1rem !important;
    border-radius: 0 !important;
    border-left: none !important;
    border-right: none !important;
  }
  
  .language-label {
    left: 1rem !important;
  }
  
  .copy-button {
    right: 1rem !important;
  }
  
  .prose pre:has(.language-label) {
    border-top-left-radius: 0 !important;
    border-top-right-radius: 0 !important;
  }
}

/* ==============================================
   高对比度主题（可选）
   ============================================== */

@media (prefers-contrast: high) {
  :root {
    --code-bg: #ffffff;
    --code-border: #000000;
    --code-text: #000000;
    --code-comment: #666666;
    --code-keyword: #0000ff;
    --code-string: #008000;
    --code-number: #ff0000;
    --code-function: #0066cc;
  }
  
  .dark {
    --code-bg: #000000;
    --code-border: #ffffff;
    --code-text: #ffffff;
    --code-comment: #cccccc;
    --code-keyword: #66b3ff;
    --code-string: #66ff66;
    --code-number: #ff6666;
    --code-function: #66ccff;
  }
}

/* ==============================================
   打印样式
   ============================================== */

@media print {
  .prose pre {
    background: #f8f9fa !important;
    border: 1px solid #dee2e6 !important;
    color: #212529 !important;
    page-break-inside: avoid !important;
  }
  
  .copy-button,
  .language-label {
    display: none !important;
  }
}
